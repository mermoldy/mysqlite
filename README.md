# mysqlite

A playground for learning database stuff.

The goal of this project is to build a toy SQLite clone by following the tutorial <https://cstack.github.io/db_tutorial> (C -> Rust), develop an ORM based on it, and design an application using it â€” <https://kb.databasedesignbook.com/posts/google-calendar>.

## Design

The internal architecture follows SQLiteâ€™s design:

<p align="center">
  <img src="https://cstack.github.io/db_tutorial/assets/images/arch2.gif"/>
</p>

The UI follows a more common MySQL-style interface.

## ðŸ“Œ SQLite Clone - Progress Tracker

First part is to imlement basic stuff using <https://cstack.github.io/db_tutorial>.

- [x] **Part 1** - Introduction and Setting up the REPL
- [ ] **Part 2** - Worldâ€™s Simplest SQL Compiler and Virtual Machine
- [ ] **Part 3** - An In-Memory, Append-Only, Single-Table Database
- [ ] **Part 4** - Our First Tests (and Bugs)
- [ ] **Part 5** - Persistence to Disk
- [ ] **Part 6** - The Cursor Abstraction
- [ ] **Part 7** - Introduction to the B-Tree
- [ ] **Part 8** - B-Tree Leaf Node Format
- [ ] **Part 9** - Binary Search and Duplicate Keys
- [ ] **Part 10** - Splitting a Leaf Node
- [ ] **Part 11** - Recursively Searching the B-Tree
- [ ] **Part 12** - Scanning a Multi-Level B-Tree
- [ ] **Part 13** - Updating Parent Node After a Split
- [ ] **Part 14** - Splitting Internal Nodes
- [ ] **Part 15** - Where to go next

### How SQLite works

A query goes through a chain of components in order to retrieve or modify data. The front-end consists of the:

- tokenizer
- parser
- code generator

The input to the front-end is a SQL query. the output is sqlite virtual machine bytecode (essentially a compiled program that can operate on the database).

The back-end consists of the:

- virtual machine
- B-tree
- pager
- os interface

The virtual machine takes bytecode generated by the front-end as instructions. It can then perform operations on one or more tables or indexes, each of which is stored in a data structure called a B-tree. **The VM is essentially a big switch statement on the type of bytecode instruction.**

**Each B-tree consists of many nodes. Each node is one page in length.** The B-tree can retrieve a page from disk or save it back to disk by issuing commands to the pager.

The pager receives commands to read or write pages of data. It is responsible for reading/writing at appropriate offsets in the database file. It also keeps a cache of recently-accessed pages in memory, and determines when those pages need to be written back to disk.

The os interface is the layer that differs depending on which operating system sqlite was compiled for.
